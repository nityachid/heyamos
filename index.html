<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Carousell Luxury ‚Äî AEO Dashboard v12 (Luxury Resale, SG)</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    * { box-sizing:border-box; }
    body { font-family:-apple-system,BlinkMacSystemFont,'SF Pro Display','Inter',sans-serif; background:#F5F5F7; margin:0; padding:24px; color:#1D1D1F; -webkit-font-smoothing:antialiased; }
    .container{ max-width:1150px; margin:0 auto; }
    .content{ background:#FFF; border-radius:16px; padding:32px; box-shadow:0 4px 16px rgba(0,0,0,.06); }
    .progress{ display:flex; align-items:center; gap:8px; color:#86868B; margin-bottom:16px; font-size:13px; font-weight:600; }
    .progress-dot{ width:8px; height:8px; background:#4A9B8E; border-radius:50%; }
    .question{ font-size:24px; font-weight:700; margin-bottom:16px; }
    .input{ width:100%; height:50px; padding:12px 14px; font-size:16px; border-radius:12px; border:1px solid #D2D2D7; outline:none; transition:.2s; }
    .input:focus{ border:2px solid #4A9B8E; box-shadow:0 0 0 4px rgba(74,155,142,.12); }
    .button{ padding:12px 18px; border-radius:12px; font-weight:700; font-size:14px; background:#4A9B8E; color:#FFF; border:none; cursor:pointer; transition:.15s; }
    .button:hover{ background:#3d8275; transform:translateY(-1px); box-shadow:0 4px 12px rgba(74,155,142,.3); }
    .button:disabled{ opacity:.5; cursor:not-allowed; }
    .tabbar{ position:sticky; top:0; background:#FFF; padding:8px 0; z-index:10; border-bottom:1px solid #E5E7EB; display:flex; gap:8px; }
    .tab{ border:none; background:#F3F4F6; color:#111827; padding:8px 14px; border-radius:22px; font-weight:700; cursor:pointer; }
    .tab.active{ background:#4A9B8E; color:#FFF; }
    .section{ display:none; }
    .section.active{ display:block; animation:fade .35s ease; }
    @keyframes fade{ from{opacity:0; transform:translateY(6px)} to{opacity:1; transform:none} }
    .report-header{ text-align:center; padding:24px 0 28px; }
    .report-title{ font-size:34px; font-weight:800; letter-spacing:-.02em; }
    .badge{ display:inline-flex; gap:6px; align-items:center; padding:6px 12px; border-radius:20px; font-size:13px; font-weight:700; }
    .badge.good{ background:#E8F8ED; color:#059669; }
    .card{ background:#FAFAFA; border:1px solid #E8E8ED; border-radius:12px; padding:18px; }
    .accordion{ background:#FFF; border:1px solid #E8E8ED; border-radius:12px; overflow:hidden; margin-bottom:10px; }
    .accordion:hover{ box-shadow:0 2px 10px rgba(0,0,0,.05); }
    .acc-head{ display:flex; justify-content:space-between; align-items:center; padding:18px 20px; cursor:pointer; }
    .acc-title{ font-size:16px; font-weight:700; }
    .acc-chev{ color:#6B7280; transition:.2s; }
    .accordion.expanded .acc-chev{ transform:rotate(180deg); }
    .acc-body{ max-height:0; overflow:hidden; transition:max-height .35s ease; background:#FAFAFA; border-top:1px solid #E8E8ED; }
    .accordion.expanded .acc-body{ max-height:1000px; }
    table{ width:100%; border-collapse:collapse; }
    th,td{ padding:10px 12px; font-size:13px; }
    thead th{ background:#4A9B8E; color:#FFF; text-align:left; }
    .pill{ display:inline-block; padding:2px 8px; border-radius:8px; font-size:12px; font-weight:700; }
    .pill.pos{ background:#E8F8ED; color:#059669; }
    .pill.neu{ background:#F3F4F6; color:#374151; }
    .pill.neg{ background:#FEE2E2; color:#B91C1C; }
    .gap-card{ background:#FFF; border:2px solid #E8E8ED; border-radius:12px; padding:20px; margin-bottom:14px; }
    .gap-card:hover{ border-color:#4A9B8E; box-shadow:0 4px 12px rgba(74,155,142,.15); }
    .tick{ width:20px; height:20px; border:2px solid #D1D5DB; border-radius:6px; display:flex; align-items:center; justify-content:center; cursor:pointer; }
    .tick.checked{ background:#4A9B8E; border-color:#4A9B8E; color:#FFF; font-weight:900; }
    .chart-wrap{ position:relative; background:#FAFAFA; border:1px solid #E8E8ED; border-radius:12px; padding:16px; }
    canvas{ display:block; width:100%; height:300px; }
    .tooltip{ position:absolute; background:#111827; color:#FFF; padding:10px 12px; font-size:12px; border-radius:8px; box-shadow:0 6px 20px rgba(0,0,0,.3); pointer-events:none; display:none; white-space:nowrap; }
    .hero{ background:linear-gradient(135deg,#F0F9FF 0%,#E0F2FE 100%); border:1px solid #BAE6FD; border-radius:16px; padding:28px; text-align:center; }
    .subtle{ color:#6B7280; font-size:13px; }
    .opp-cards{display:grid;grid-template-columns:repeat(auto-fit,minmax(300px,1fr));gap:16px;margin-top:20px;}
    .opp-card{background:#FFF;border-radius:14px;box-shadow:0 3px 12px rgba(0,0,0,.04);padding:18px 20px;border-left:5px solid #4A9B8E;transition:.2s;}
    .opp-card:hover{transform:translateY(-3px);box-shadow:0 6px 18px rgba(0,0,0,.08);}
    .opp-card h4{margin:0 0 6px;font-size:16px;}
    .opp-card p{margin:0;font-size:14px;color:#374151;}
    .ghost-btn{background:transparent;border:1.5px solid #4A9B8E;color:#4A9B8E;padding:10px 18px;border-radius:8px;cursor:pointer;font-weight:700;margin-top:10px;}
    .ghost-btn:hover{background:#E8F8ED;}
    @keyframes spin{ from{transform:rotate(0)} to{transform:rotate(360deg)} }
  </style>
</head>
<body>
<div class="container">
  <div class="content" id="root">
    <!-- Step 1 -->
    <div class="progress"><div class="progress-dot"></div><span>Step 1 of 5</span></div>
    <div class="question">What is your category?</div>
    <input id="cat" class="input" placeholder="Enter your category" />
    <div style="margin-top:14px;"><button id="btn1" class="button" disabled>Continue</button> <span class="subtle">Prefilled: Luxury Resale & Authentication</span></div>
  </div>
</div>

<script>
let state = {};
const root = document.getElementById('root');
const cat = document.getElementById('cat');
const btn1 = document.getElementById('btn1');
setTimeout(()=>{cat.value='Luxury Resale & Authentication'; state.category='Luxury Resale & Authentication'; btn1.disabled=false;},250);
cat.oninput=()=>{state.category=cat.value.trim(); btn1.disabled=!state.category; };
btn1.onclick=step2;

function step2(){
  root.innerHTML = `
    <div class="progress"><div class="progress-dot"></div><span>Step 2 of 5</span></div>
    <div class="question">What is your brand?</div>
    <input id="brand" class="input" placeholder="Enter your brand" />
    <div style="margin-top:14px;"><button id="btn2" class="button" disabled>Continue</button> <span class="subtle">Prefilled: Carousell Luxury</span></div>`;
  const b=document.getElementById('brand'); const btn2=document.getElementById('btn2');
  setTimeout(()=>{b.value='Carousell Luxury'; state.brand='Carousell Luxury'; btn2.disabled=false;},200);
  b.oninput=()=>{state.brand=b.value.trim(); btn2.disabled=!state.brand; };
  btn2.onclick=step3;
}

function step3(){
  root.innerHTML = `
    <div class="progress"><div class="progress-dot"></div><span>Step 3 of 5</span></div>
    <div class="question">Which country/market?</div>
    <input id="country" class="input" placeholder="Enter market" />
    <div style="margin-top:14px;"><button id="btn3" class="button" disabled>Continue</button> <span class="subtle">Prefilled: Singapore</span></div>`;
  const c=document.getElementById('country'); const btn3=document.getElementById('btn3');
  setTimeout(()=>{c.value='Singapore'; state.country='Singapore'; btn3.disabled=false;},200);
  c.oninput=()=>{state.country=c.value.trim(); btn3.disabled=!state.country; };
  btn3.onclick=step4;
}

function step4(){
  root.innerHTML = `
    <div class="progress"><div class="progress-dot"></div><span>Step 4 of 5</span></div>
    <div class="question">Website?</div>
    <input id="site" class="input" placeholder="Enter website URL" />
    <div style="margin-top:14px;"><button id="btn4" class="button" disabled>Continue</button> <span class="subtle">Prefilled: carousell.sg/luxury</span></div>`;
  const s=document.getElementById('site'); const btn4=document.getElementById('btn4');
  setTimeout(()=>{s.value='https://www.carousell.sg/'; state.website=s.value; btn4.disabled=false;},200);
  s.oninput=()=>{state.website=s.value.trim(); btn4.disabled=!state.website; };
  btn4.onclick=step5;
}

function step5(){
  root.innerHTML = `
    <div class="progress"><div class="progress-dot"></div><span>Step 5 of 5</span></div>
    <div class="question">Top competitors</div>
    <input id="c1" class="input" placeholder="Competitor 1" />
    <input id="c2" class="input" placeholder="Competitor 2" style="margin-top:10px;" />
    <input id="c3" class="input" placeholder="Competitor 3" style="margin-top:10px;" />
    <div style="margin-top:14px;"><button id="btn5" class="button" disabled>Generate Report</button> <span class="subtle">Prefilled: Reebonz, Vestiaire Collective, The Fifth Collection</span></div>`;
  const c1=document.getElementById('c1'), c2=document.getElementById('c2'), c3=document.getElementById('c3'), btn5=document.getElementById('btn5');
  setTimeout(()=>{c1.value='Reebonz';c2.value='Vestiaire Collective';c3.value='The Fifth Collection'; state.c1=c1.value; state.c2=c2.value; state.c3=c3.value; btn5.disabled=false;},200);
  [c1,c2,c3].forEach(el=>el.oninput=()=>{state.c1=c1.value.trim();state.c2=c2.value.trim();state.c3=c3.value.trim(); btn5.disabled=!(state.c1||state.c2||state.c3);});
  btn5.onclick=loading;
}

/* Loading */
function loading(){
  const steps=[
    'Crawling Carousell Luxury marketplace & trust pages',
    'Parsing authentication & buyer protection content',
    'Analyzing Reebonz, Vestiaire & The Fifth Collection visibility',
    'Processing high‚Äëintent queries (authenticate, buy, sell)',
    'Computing Share of Voice & sentiment across AI engines',
    'Detecting visibility gaps (authentication, returns, concierge)',
    'Building competitive leaderboards & charts',
    'Generating Carousell Luxury dashboard for Singapore'
  ];
  let html = `<div style="text-align:center;padding:56px 12px;">
    <div style="width:64px;height:64px;border:4px solid #E5E7EB;border-top:4px solid #4A9B8E;border-radius:50%;animation:spin 1s linear infinite;margin:0 auto;"></div>
    <h2 style="margin:18px 0 6px;">Generating your Carousell Luxury report‚Ä¶</h2>
    <div class="subtle">High-fidelity analysis for ${state.country||'Singapore'}</div>
    <div style="max-width:520px;margin:18px auto;text-align:left;">`;
  steps.forEach((t,i)=>{
    html+=`<div id="lg${i}" style="opacity:.45;display:flex;align-items:center;gap:10px;padding:10px 0;">
      <div style="width:16px;height:16px;border:2px solid #D1D5DB;border-radius:50%;"></div>
      <div>${t}</div>
    </div>`;
  });
  html+=`</div></div>`;
  root.innerHTML = html;
  steps.forEach((_,i)=>setTimeout(()=>{
    const el=document.getElementById('lg'+i);
    if(!el) return;
    el.style.opacity=1;
    const dot=el.children[0];
    dot.style.background='#4A9B8E'; dot.style.border='2px solid #4A9B8E'; dot.innerHTML='<span style="color:#FFF;font-size:10px;font-weight:900;">‚úì</span>';
  }, i*1100));
  setTimeout(dashboard, steps.length*1100+300);
}

/* Dashboard */
function dashboard(){
  const brand = state.brand || 'Carousell Luxury';
  const comp1 = state.c1 || 'Reebonz', comp2 = state.c2 || 'Vestiaire Collective', comp3 = state.c3 || 'The Fifth Collection';

  root.innerHTML = `
    <div class="tabbar">
      <button class="tab active" onclick="switchTab('overview', this)">üí¨ Channel Overview</button>
      <button class="tab" onclick="switchTab('strengths', this)">üí™ Strengths</button>
      <button class="tab" onclick="switchTab('gaps', this)">‚ö†Ô∏è Gaps</button>
      <button class="tab" onclick="switchTab('opps', this)">üöÄ Opportunities</button>
    </div>

    <div id="overview" class="section active">
      <div class="report-header">
        <div class="report-title">${brand} in ${state.country || 'Singapore'}</div>
        <div style="font-size:72px;font-weight:900;color:#4A9B8E;line-height:1;">64</div>
        <div class="badge good" style="margin-top:8px;"><span>‚Üë</span><span>+5% from last month</span></div>
        <div style="margin-top:10px;" class="subtle">Category: ${state.category || 'Luxury Resale & Authentication'}</div>
      </div>

      <div class="chart-wrap">
        <div style="font-weight:800;margin-bottom:8px;">Competitor Share of Voice ‚Äî last 6 months</div>
        <canvas id="sov"></canvas>
        <div id="tip" class="tooltip"></div>
      </div>

      <div style="margin:10px 0 24px;" class="subtle">
        ${brand} leads in **local reach** and **speed to sell**, while ${comp2} dominates ‚Äúsustainability & global buyer‚Äù narratives.
      </div>

      <h3 style="font-size:18px;margin:10px 0 8px;">Top Prompts for Your Category</h3>
      <div class="card">
        <table>
          <thead><tr><th>Prompt</th><th>Volume</th><th>Rank</th><th>Perception</th></tr></thead>
          <tbody>
            <tr><td>Best place to buy authentic luxury bags Singapore</td><td><span class="pill pos">High</span></td><td><strong>1</strong></td><td><span class="pill pos">Positive</span></td></tr>
            <tr><td>${comp2} vs ${brand} (fees, authenticity, shipping)</td><td><span class="pill neu">High</span></td><td><strong>2</strong></td><td><span class="pill neu">Neutral</span></td></tr>
            <tr><td>How to authenticate a Chanel bag Singapore</td><td><span class="pill neu">Medium</span></td><td><strong>2</strong></td><td><span class="pill pos">Positive</span></td></tr>
            <tr><td>Sell my designer bag fast Singapore</td><td><span class="pill neu">Medium</span></td><td><strong>1</strong></td><td><span class="pill pos">Positive</span></td></tr>
          </tbody>
        </table>
      </div>
    </div>

    <div id="strengths" class="section">
      <h2 style="margin:12px 0 8px;">High-Visibility Wins</h2>
      ${[
        {
          q:'Best place to buy authentic luxury bags Singapore',
          rank:1, mentions:44, vis:'72%', perception:'Positive',
          authority:'Honeycombers, Tatler, local KOL roundups', competitors:`${comp2}, ${comp1}`,
          how:'Appears as trusted local marketplace with buyer protection & strong selection',
          defend:[
            'Keep trust badges & buyer protection copy above the fold on category pages',
            `Update ‚ÄúTop authentic sellers in SG‚Äù editorial monthly`,
            'Pin verified authentication partners on PDPs (badge + link)'
          ]
        },
        {
          q:`${comp2} vs ${brand} (fees, authenticity, shipping)`,
          rank:2, mentions:29, vis:'60%', perception:'Neutral',
          authority:'Reddit r/SGExpat, forum threads, price comparison blogs', competitors:`${comp2}`,
          how:'Strong on fees & speed, weaker on global reach & sustainability points',
          defend:[
            'Create a living comparison page: fees, shipping time, returns policy',
            'Showcase ‚ÄúSell Fast‚Äù success metrics (median time-to-sale, SG only)',
            'Add ‚Äúre-commerce sustainability impact‚Äù stats to close narrative gap'
          ]
        },
        {
          q:'How to authenticate a Chanel bag Singapore',
          rank:2, mentions:21, vis:'58%', perception:'Positive',
          authority:'Bag forums, YouTube KOLs, brand care guides', competitors:`${comp1}, ${comp3}`,
          how:'Highlighted for third-party authenticator integrations & dispute process',
          defend:[
            'Publish ‚ÄúAuthentication 101‚Äù microsite with step-by-step visuals',
            'Bundle authentication + escrow in one CTA on listing flow',
            'Quarterly AMAs with certified authenticators on IG/YouTube'
          ]
        }
      ].map((p,i)=>`
        <div class="accordion" style="border-left:4px solid ${i===0?'#10B981':'#3B82F6'};">
          <div class="acc-head" onclick="toggleAcc(this)">
            <div class="acc-title">${p.rank===1?'üèÜ ':''}${p.q}</div>
            <div class="acc-chev">‚ñº</div>
          </div>
          <div class="acc-body">
            <div style="padding:18px;">
              <div style="background:${p.rank===1?'#E8F8ED':'#EFF6FF'}; border-left:3px solid ${p.rank===1?'#10B981':'#3B82F6'}; padding:14px; border-radius:10px; margin-bottom:12px;">
                <div style="font-size:12px;font-weight:900;letter-spacing:.5px;text-transform:uppercase;">Your Position</div>
                <div style="font-size:18px;font-weight:800;margin-top:4px;">Rank #${p.rank} ‚Ä¢ ${p.vis} visibility ‚Ä¢ ${p.mentions} mentions</div>
              </div>

              <div style="margin-bottom:12px;">
                <div style="font-weight:800;margin-bottom:6px;">Competitive Leaderboard</div>
                <table>
                  <thead><tr><th>Brand</th><th>Position</th><th style="text-align:right;">Visibility</th></tr></thead>
                  <tbody>
                    ${p.rank===1 ? `
                      <tr style="background:#E8F8ED;"><td>${brand} (You)</td><td>1</td><td style="text-align:right;">${p.vis}</td></tr>
                      <tr><td>${p.competitors.split(',')[0]}</td><td>2</td><td style="text-align:right;">55%</td></tr>
                      <tr><td>${p.competitors.split(',')[1]||comp1}</td><td>3</td><td style="text-align:right;">49%</td></tr>
                    ` : `
                      <tr><td>${p.competitors.split(',')[0]}</td><td>1</td><td style="text-align:right;">65%</td></tr>
                      <tr style="background:#E8F8ED;"><td>${brand} (You)</td><td>2</td><td style="text-align:right;">${p.vis}</td></tr>
                      <tr><td>${p.competitors.split(',')[1]||comp3}</td><td>3</td><td style="text-align:right;">46%</td></tr>
                    `}
                  </tbody>
                </table>
              </div>

              <div class="card" style="margin-bottom:12px;">
                <div style="font-weight:800;margin-bottom:6px;">Why You're Winning</div>
                <div><strong>Top Citations:</strong> ${p.authority}</div>
                <div><strong>Perception:</strong> <span class="pill ${p.perception==='Positive'?'pos':p.perception==='Negative'?'neg':'neu'}">${p.perception}</span></div>
                <div style="margin-top:6px;"><strong>How You Appear:</strong> ${p.how}</div>
              </div>

              <div style="background:#FFFBEB;border:1px solid #FDE68A;padding:12px;border-radius:10px;">
                <div style="font-weight:800;color:#92400E;margin-bottom:6px;">üõ°Ô∏è Defend This Lead</div>
                <ul style="margin:0 0 0 18px;">
                  ${p.defend.map(d=>`<li style="margin:6px 0;">${d}</li>`).join('')}
                </ul>
              </div>
            </div>
          </div>
        </div>
      `).join('')}
    </div>

    <div id="gaps" class="section">
      <h2 style="margin:12px 0 8px;">Where You're Missing Out</h2>
      ${[
        {
          id:'gap1', title:'Authentication proof UX is buried on PDPs', impact:7,
          desc:`${comp2} sets the standard with visible authenticity trackers; ${brand} info sits below the fold.`,
          current:'Users scroll >50% to find trust info', comp:'${comp2} shows trust above the fold',
          tactics:[
            'Move ‚ÄúVerified by [Partner]‚Äù + report preview to the first screen',
            'Add standardized authenticity badge to search cards & seller pages',
            'Show refund/appeal SLA inline near ‚ÄúBuy‚Äù CTA'
          ],
          compTable:[
            ['Vestiaire Collective', '1.8', '66%'],
            [`${brand} (You)`, '3.5', '54%'],
            ['Reebonz', '3.9', '49%']
          ],
          examples:[
            ['is carousell luxury authentic', 'Rank #3 ‚Ä¢ 6 mentions', 'Missing above-the-fold proof'],
            ['carousell buyer protection luxury', 'Rank #4 ‚Ä¢ 5 mentions', 'Policy page not linked on PDP']
          ]
        },
        {
          id:'gap2', title:'Lower visibility for ‚Äúsell my designer bag fast‚Äù outside SG', impact:8,
          desc:`${comp2} wins ‚Äúglobal buyers‚Äù intent; ${brand} wins only in SG‚Äëcentric threads.`,
          current:'Rank #4 (regional queries)', comp:'${comp2} dominates #1‚Äì2',
          tactics:[
            'Create ‚ÄúGlobal buyers on Carousell‚Äù landing with intl shipping partners',
            'Offer concierge selling (pickup, photo, list) for top brands',
            'Surface cross-border demand stats on seller onboarding'
          ],
          compTable:[
            ['Vestiaire Collective', '1.6', '68%'],
            [`${brand} (You)`, '4.1', '47%']
          ],
          examples:[
            ['sell chanel bag asia fastest', 'Rank #5 ‚Ä¢ 3 mentions', 'No cross-border proof points'],
            ['best place to sell hermes bag international', 'Not appearing ‚Ä¢ 0 mentions', 'No dedicated content']
          ]
        },
        {
          id:'gap3', title:'Returns & dispute policy not discoverable in AI answers', impact:6,
          desc:'Forums mention uncertainty on returns; ${comp3} offers editorial clarity.',
          current:'Rank #5 on ‚Äúreturns‚Äù prompts', comp:'The Fifth Collection shows clear policy CTA',
          tactics:[
            'Write a single ‚ÄúLuxury Returns & Disputes‚Äù canonical page with FAQ',
            'Add structured data (FAQPage) for policy questions',
            'Short explainer video linked from every luxury PDP'
          ],
          compTable:[
            ['The Fifth Collection', '2.2', '61%'],
            [`${brand} (You)`, '4.6', '45%']
          ],
          examples:[
            ['carousell luxury returns policy', 'Rank #5 ‚Ä¢ 4 mentions', 'Fragmented information across pages'],
            ['what if luxury item is fake carousell', 'Rank #6 ‚Ä¢ 3 mentions', 'Appeals flow unclear in summaries']
          ]
        }
      ].map(g=>`
        <div class="gap-card" id="${g.id}" data-impact="${g.impact}">
          <div style="display:flex;justify-content:space-between;gap:16px;">
            <div style="flex:1;">
              <div style="font-size:18px;font-weight:800;margin-bottom:4px;">${g.title}</div>
              <div class="subtle" style="margin-bottom:10px;">${g.desc}</div>
              <div style="display:grid;grid-template-columns:1fr 1fr;gap:10px;">
                <div class="card"><div class="subtle">Current</div><div style="font-weight:800">${g.current}</div></div>
                <div class="card"><div class="subtle">Competitors</div><div style="font-weight:800">${g.comp}</div></div>
              </div>
            </div>
            <div style="text-align:right;">
              <div style="font-size:34px;font-weight:900;color:#059669;">+${g.impact}%</div>
              <div class="subtle" style="font-weight:800;">OPPORTUNITY</div>
              <div class="tick" onclick="toggleGap('${g.id}', ${g.impact})"></div>
              <div class="subtle" style="margin-top:6px;">Mark priority</div>
            </div>
          </div>

          <div style="margin-top:12px;">
            <div style="font-weight:800;margin-bottom:6px;">Tactics</div>
            <ul style="margin:0 0 0 18px;">
              ${g.tactics.map(t=>`<li style="margin:6px 0;">${t}</li>`).join('')}
            </ul>
          </div>

          <div style="margin-top:12px;padding-top:12px;border-top:1px solid #E8E8ED;">
            <div style="display:flex;align-items:center;justify-content:space-between;cursor:pointer;" onclick="toggleBlock('${g.id}-comp')">
              <div style="font-weight:800;color:#4A9B8E;">View Competitive Position</div>
              <div id="${g.id}-comp-chev" class="acc-chev">‚ñº</div>
            </div>
            <div id="${g.id}-comp" style="display:none;margin-top:10px;">
              <table>
                <thead><tr><th>Brand</th><th>Position</th><th style="text-align:right;">Visibility</th></tr></thead>
                <tbody>
                  ${g.compTable.map(r=>`<tr><td>${r[0]}</td><td>${r[1]}</td><td style="text-align:right;">${r[2]}</td></tr>`).join('')}
                </tbody>
              </table>
            </div>
          </div>

          <div style="margin-top:12px;padding-top:12px;border-top:1px solid #E8E8ED;">
            <div style="display:flex;align-items:center;justify-content:space-between;cursor:pointer;" onclick="toggleBlock('${g.id}-ex')">
              <div style="font-weight:800;color:#4A9B8E;">View Example Queries</div>
              <div id="${g.id}-ex-chev" class="acc-chev">‚ñº</div>
            </div>
            <div id="${g.id}-ex" style="display:none;margin-top:10px;">
              ${g.examples.map(e=>`
                <div class="card" style="margin-bottom:8px;border-left:3px solid #4A9B8E;">
                  <div style="font-weight:700">${e[0]}</div>
                  <div class="subtle">${e[1]}</div>
                  <div class="subtle">${e[2]}</div>
                </div>
              `).join('')}
            </div>
          </div>
        </div>
      `).join('')}
    </div>

    <div id="opps" class="section">
      <div class="hero">
        <div style="color:#0369A1;font-weight:900;letter-spacing:.08em;text-transform:uppercase;font-size:12px;">Visibility Potential</div>
        <div id="gain" style="font-size:64px;font-weight:900;color:#0C4A6E;letter-spacing:-.03em;margin:6px 0;">+19%</div>
        <div style="color:#0369A1;font-size:15px;margin-bottom:6px;">${brand} can unlock an additional +19% visibility share by fixing authentication UX, cross-border selling, and returns discoverability.</div>
        <div style="max-width:640px;margin:14px auto 0;">
          <div style="position:relative;height:14px;background:#E0F2FE;border-radius:8px;overflow:hidden;">
            <div id="bar" style="position:absolute;left:0;top:0;height:100%;width:64%;background:linear-gradient(90deg,#0EA5E9,#0284C7);"></div>
            <div style="position:absolute;left:64%;top:0;height:100%;width:19%;background:linear-gradient(90deg,rgba(16,185,129,.3),rgba(5,150,105,.3));"></div>
          </div>
          <div style="display:flex;justify-content:space-between;margin-top:8px;font-weight:800;">
            <span class="subtle">Current: <span id="sovNow">64</span>%</span>
            <span style="color:#059669;">Target: 83%</span>
          </div>
        </div>
        <div style="margin-top:10px;">
          <span class="badge good">üü¢ Local Trust & Speed</span>
          <span class="badge good">üîµ Authentication Integrations</span>
          <span class="badge good">üü† Cross‚Äëborder Growth</span>
        </div>
      </div>

      <h3 style="margin-top:30px;margin-bottom:8px;">Where the Growth Comes From</h3>
      <div class="opp-cards">
        <div class="opp-card" style="border-left-color:#10B981;">
          <h4>üîí Authentication Proof (+7%)</h4>
          <p>Elevate trust signals to the first screen and standardize badges across PDP, search results, and seller pages.</p>
        </div>
        <div class="opp-card" style="border-left-color:#3B82F6;">
          <h4>üåè Cross‚ÄëBorder Selling (+8%)</h4>
          <p>Showcase global demand metrics and enable concierge listing for top-tier brands to attract sellers.</p>
        </div>
        <div class="opp-card" style="border-left-color:#F59E0B;">
          <h4>‚Ü©Ô∏è Returns Clarity (+4%)</h4>
          <p>One canonical returns/dispute page with FAQ + schema to surface directly in AI answers.</p>
        </div>
      </div>

      <h3 style="margin-top:32px;margin-bottom:10px;">Strategic Actions to Capture Opportunity</h3>
      <div class="accordion expanded">
        <div class="acc-head" onclick="toggleAcc(this)">
          <div class="acc-title">Make Trust Obvious</div>
          <div class="acc-chev">‚ñº</div>
        </div>
        <div class="acc-body" style="max-height:1000px;">
          <div style="padding:16px 18px;">
            <ul style="margin:0 0 0 18px;">
              <li>Authentication badge + preview report above the fold.</li>
              <li>Show refund/appeal SLA inline with the purchase CTA.</li>
              <li>‚ÄúMeet the Authenticators‚Äù content hub + quarterly AMAs.</li>
            </ul>
          </div>
        </div>
      </div>
      <div class="accordion expanded">
        <div class="acc-head" onclick="toggleAcc(this)">
          <div class="acc-title">Unlock Global Demand</div>
          <div class="acc-chev">‚ñº</div>
        </div>
        <div class="acc-body" style="max-height:1000px;">
          <div style="padding:16px 18px;">
            <ul style="margin:0 0 0 18px;">
              <li>Dedicated ‚ÄúGlobal buyers on Carousell‚Äù landing page.</li>
              <li>Concierge selling for Hermes, Chanel, Rolex categories.</li>
              <li>Cross-border shipping partners & delivery estimates on PDP.</li>
            </ul>
          </div>
        </div>
      </div>
      <div class="accordion expanded">
        <div class="acc-head" onclick="toggleAcc(this)">
          <div class="acc-title">Answer Returns Questions Where They Start</div>
          <div class="acc-chev">‚ñº</div>
        </div>
        <div class="acc-body" style="max-height:1000px;">
          <div style="padding:16px 18px;">
            <ul style="margin:0 0 0 18px;">
              <li>Canonical returns/disputes page + FAQPage schema.</li>
              <li>Short explainer video linked on all luxury PDPs.</li>
              <li>Community answers mirrored to forums (Reddit, HardwareZone).</li>
            </ul>
          </div>
        </div>
      </div>

      <h3 style="margin-top:32px;margin-bottom:8px;">Competitive Outlook</h3>
      <table>
        <thead><tr><th>Brand</th><th>Share of Voice</th><th>Trend</th></tr></thead>
        <tbody>
          <tr><td>${brand}</td><td>64%</td><td style="color:#059669;">‚ñ≤ +5%</td></tr>
          <tr><td>${comp2}</td><td>57%</td><td style="color:#059669;">‚ñ≤ +3%</td></tr>
          <tr><td>${comp1}</td><td>34%</td><td style="color:#B91C1C;">‚ñº ‚Äì2%</td></tr>
          <tr><td>${comp3}</td><td>29%</td><td>‚ûñ 0%</td></tr>
        </tbody>
      </table>

      <div class="subtle" style="text-align:center;margin-top:16px;">
        Prioritize <strong>Authentication Proof</strong> and <strong>Cross‚ÄëBorder Selling</strong> to push ${brand} beyond <strong>80% visibility</strong> ‚Äî clear category leadership in SG.
        <div><button class="ghost-btn" onclick="alert('Generating Opportunity Summary‚Ä¶')">Download Opportunity Summary</button></div>
      </div>
    </div>
  `;

  renderChart();
  animateNum('gain', 0, 19, 900, v => `+${v}%`);
}

function switchTab(id, btn){
  document.querySelectorAll('.tab').forEach(t=>t.classList.remove('active'));
  btn.classList.add('active');
  document.querySelectorAll('.section').forEach(s=>s.classList.remove('active'));
  document.getElementById(id).classList.add('active');
}

/* Accordions */
function toggleAcc(head){
  const acc = head.parentElement;
  acc.classList.toggle('expanded');
  const body = head.nextElementSibling;
  if(acc.classList.contains('expanded')) body.style.maxHeight='1000px';
  else body.style.maxHeight='0';
}
function toggleBlock(id){
  const el=document.getElementById(id);
  const chev=document.getElementById(id+'-chev');
  const showing=el.style.display!=='none';
  el.style.display = showing ? 'none' : 'block';
  if(chev) chev.style.transform = showing ? 'rotate(0deg)' : 'rotate(180deg)';
}

/* Gaps ‚Üí dynamic opportunity */
let added = 0;
function toggleGap(id, impact){
  const card=document.getElementById(id);
  const box=card.querySelector('.tick');
  const checked=box.classList.contains('checked');
  if(checked){ box.classList.remove('checked'); box.innerHTML=''; added-=impact; }
  else { box.classList.add('checked'); box.innerHTML='‚úì'; added+=impact; }
  const now = Math.min(83, 64 + added);
  const sovEl = document.getElementById('sovNow');
  if(sovEl){ sovEl.textContent = now; }
  const barEl = document.getElementById('bar');
  if(barEl){ barEl.style.width = now+'%'; }
}

/* Animate numbers */
function animateNum(id, start, end, dur, fmt){
  const el=document.getElementById(id);
  if(!el) return;
  const t0=performance.now();
  (function frame(t){
    const p=Math.min(1,(t-t0)/dur);
    const v=Math.round(start + (end-start)*(p<.5?2*p*p:-1+(4-2*p)*p));
    el.textContent = fmt ? fmt(v) : v;
    if(p<1) requestAnimationFrame(frame);
  })(t0);
}

/* Interactive chart (pure canvas) */
function renderChart(){
  const canvas=document.getElementById('sov');
  const ctx=canvas?.getContext('2d');
  if(!ctx) return;
  const dpr = window.devicePixelRatio || 1;
  const rect = canvas.getBoundingClientRect();
  canvas.width = Math.floor(rect.width * dpr);
  canvas.height = Math.floor(300 * dpr);
  ctx.scale(dpr,dpr);

  const W = rect.width, H = 300, pad=40;
  const months=['May','Jun','Jul','Aug','Sep','Oct'];
  const series={
    [state.brand||'Carousell Luxury']:[56,58,59,61,62,64],
    [state.c2||'Vestiaire Collective']:[50,51,52,54,55,57],
    [state.c1||'Reebonz']:[37,36,35,35,34,34],
    [state.c3||'The Fifth Collection']:[28,28,28,29,29,29]
  };
  const colors=['#10B981','#3B82F6','#F59E0B','#EF4444'];

  function x(i){ return pad + i*((W-2*pad)/(months.length-1)); }
  function y(v){ const min=0,max=90; return H-pad - ( (v-min)/(max-min) )*(H-2*pad); }

  // grid
  ctx.strokeStyle='#E5E7EB'; ctx.lineWidth=1;
  for(let i=0;i<=4;i++){ const yy=pad + i*((H-2*pad)/4); ctx.beginPath(); ctx.moveTo(pad, yy); ctx.lineTo(W-pad, yy); ctx.stroke(); }
  ctx.fillStyle='#6B7280'; ctx.font='12px system-ui';
  [0,20,40,60,80].forEach((v,i)=>{ const yy=y(v); ctx.fillText(v+'%', 8, yy+4); });
  months.forEach((m,i)=>ctx.fillText(m, x(i)-10, H-pad+18));

  const keys=Object.keys(series);
  const colorsArr=colors;

  keys.forEach((k,i)=>{
    ctx.strokeStyle=colorsArr[i]; ctx.lineWidth=2.5;
    series[k].forEach((v,idx)=>{ const X=x(idx), Y=y(v); if(idx===0){ ctx.beginPath(); ctx.moveTo(X,Y);} else ctx.lineTo(X,Y); });
    ctx.stroke();
    series[k].forEach((v,idx)=>{ const X=x(idx), Y=y(v); ctx.beginPath(); ctx.fillStyle=colorsArr[i]; ctx.arc(X,Y,3,0,Math.PI*2); ctx.fill(); });
  });

  const tip=document.getElementById('tip');
  canvas.onmousemove=(e)=>{
    const r=canvas.getBoundingClientRect();
    const mx=(e.clientX - r.left);
    let idx=0, best=1e9;
    months.forEach((_,i)=>{ const dx=Math.abs(mx - x(i)); if(dx<best){ best=dx; idx=i; } });
    const items = keys.map((k,i)=>`${k}: ${series[k][idx]}%`).join('<br>');
    tip.innerHTML = `<strong>${months[idx]} 2025</strong><br>${items}`;
    tip.style.display='block';
    tip.style.left = (x(idx)+16)+'px';
    tip.style.top = (y(85)-10)+'px';
  };
  canvas.onmouseleave=()=>{ tip.style.display='none'; };

  window.addEventListener('resize', ()=>{ renderChart(); }, {once:true});
}

// expose for onclick
window.switchTab = switchTab;
window.toggleAcc = toggleAcc;
window.toggleGap = toggleGap;
window.toggleBlock = toggleBlock;
</script>
</body>
</html>
